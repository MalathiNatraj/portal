@{
    ViewBag.Title = "SystemSummary";
}



<html>
<head>


	<!-- Set the viewport width to device width for mobile -->
	<meta name="viewport" content="width=320,user-scalable=false" />
    <script src="@Url.Content("~/Scripts/kendo.dataviz.chart.min.js")" type="text/javascript"></script>
	<link rel="stylesheet" type="text/css" href="../../Content/style.css">
    <!--[if gte IE 9]>
        <link rel="stylesheet" type="text/css" href="css/gradient-ie6-and-up.css" />
	<![endif]-->

	<title>Diebold</title>
    
    <script type="text/javascript">

        $(document).ready(function () {

            $.ajax({
                url: '@Url.Action("GetAllSystemSummaryDeviceDetails", "SystemSummary")',
                type: 'POST',
                data: { parentType: 'DVR' },
                success: function (data) {
                    $.each(data, function (index, itemData) {
                        $('#DDLSystemSummary').val('Filter by Device Type');
                        $('#DDLSystemSummary').append($('<option/>', {
                            value: itemData.Id,
                            text: itemData.Name
                        })

                        );
                    });
                },
                error: function (errordata) {
                    alert('Failure')
                }
            });



//            $('#DDLSystemSummary').change(function () {
//                var str = ""; $("select option:selected").each(function () { str += $(this).val() + " "; });
//                
//                DeviceSelected(str);
//            });

        });


        function changeImage(value) {
            var pic1 = document.getElementById("pic");
            if (value == '1') {
                pic1.src = "../../../Content/images/status-chart1.png";
            }
            if (value == '2') {
                pic1.src = "../../../Content/images/status-chart2.png";
            }
            if (value == '3') {
                pic1.src = "../../../Content/images/status-chart.png";
            }
        }

        function DeviceSelected(e) {
            //var dataItem = { "DeviceId": this.dataItem(e.item.index()).Id };
            var dataItem = { "DeviceId": e };
            
            var url = '@Url.Action("FilterByDeviceTypeId", "SystemSummary")';
            $.post(url, dataItem, GetDeviceDetailbyDeviceIdCallback, "json");
        }

        function GetDeviceDetailbyDeviceIdCallback(ResultSet) {
            var chart = $("#SystemSummarychart").data("kendoChart");
            chart.dataSource.data(ResultSet);
        }
        function fnCloseSysSummary() {
            var mySplitResultset = {
                'input': 'SystemSummary'
            };
            var url = '@Url.Action("ClosePortlet", "Preferences")';
            $.post(url, mySplitResultset, mySplitResultset, "json");

            $('#my-SysSummary').hide();
            return false;
        }

        function fntoggleSysSummary() {
            $('#divSysSummaryContent').toggle();
        }

        function loadExtraParams() {
            return { DeviceId: 2 };
        }
        function ShowSummaryDesc() {
            $("#SiteSummDescription").data("kendoWindow").center().open();
        }
	
	</script>
	<script type="text/javascript">
<!--
	    function MM_swapImgRestore() { //v3.0
	        var i, x, a = document.MM_sr; for (i = 0; a && i < a.length && (x = a[i]) && x.oSrc; i++) x.src = x.oSrc;
	    }
	    function MM_preloadImages() { //v3.0
	        var d = document; if (d.images) {
	            if (!d.MM_p) d.MM_p = new Array();
	            var i, j = d.MM_p.length, a = MM_preloadImages.arguments; for (i = 0; i < a.length; i++)
	                if (a[i].indexOf("#") != 0) { d.MM_p[j] = new Image; d.MM_p[j++].src = a[i]; }
	        }
	    }

	    function MM_findObj(n, d) { //v4.01
	        var p, i, x; if (!d) d = document; if ((p = n.indexOf("?")) > 0 && parent.frames.length) {
	            d = parent.frames[n.substring(p + 1)].document; n = n.substring(0, p);
	        }
	        if (!(x = d[n]) && d.all) x = d.all[n]; for (i = 0; !x && i < d.forms.length; i++) x = d.forms[i][n];
	        for (i = 0; !x && d.layers && i < d.layers.length; i++) x = MM_findObj(n, d.layers[i].document);
	        if (!x && d.getElementById) x = d.getElementById(n); return x;
	    }

	    function MM_swapImage() { //v3.0
	        var i, j = 0, x, a = MM_swapImage.arguments; document.MM_sr = new Array; for (i = 0; i < (a.length - 2); i += 3)
	            if ((x = MM_findObj(a[i])) != null) { document.MM_sr[j++] = x; if (!x.oSrc) x.oSrc = x.src; x.src = a[i + 2]; }
	    }
//-->
    </script>

</head>

<body onLoad="MM_preloadImages('../../Content/images/back-btn-hovr.png')">
        <!-- Main Row Starts here -->
        <div class="row">
        	<div class="sixteen columns">
            	<header>
                    <div class="sixteen columns logo-small" align="center">
                    
                    	<div class="back">
                       	  <a href="../Dashboard/Home" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('back btn','','../../Content/images/back-btn-hovr.png',1)"><img src="../../Content/images/back-btn.png" name="back btn" border="0"></a>
<!--                        	<a href="index.html"><strong>Back</strong></a>-->
                      </div>
                        
                    	<a href="#"><img src="../../../Content/images/logo-small.png" alt="" /></a>
	                    
                        <div class="log-out">
                        	<a href="../Account/LogOn"><img src="../../../Content/images/logout-icon.png" alt="" /></a>
                        </div>
                    </div>
				</header>
                
                <div class="clear"></div>	
                
                <!-- MAIN CONTAINER STARTS HERE -->
                <section>
                	<article>

                        <div class="body-bg">
                            <div class="inner-cont">
                                
                                <!-- VIDEO PAGE STARTS HERE -->
                                <div class="status">
                                    <div class="main-hdr" align="center">
                                        <h1>System Summary</h1>
                                    </div>
                                    
                                    <div class="drop-down-sel" align="center">
                                        @*onChange="changeImage(this.value);"*@
                                        <select id="DDLSystemSummary" name="DDLSystemSummary" onChange="changeImage(this.value);">
                                            <option>Filter by Device Type</option>
                                        </select>
                                    </div>
                                    
                                    <div class="status-report" id="videoImg">
                                    	<img src="../../../Content/images/status-chart.png" alt="" id="pic" />
                                    </div>
                                    <!--try start -->
                                     @*<div class="cont-inner-room">
                                       <div id="divSysSummaryContent">
                                            <div class="light-blue-body gradient">
                                                <div class="sys-summ-body-cont">
                                                    <div class="sys-summ-feed">
                                                         <div class="sys-sum-device-list">
                                                         <!--try End -->
                                                           <div class="sys-sum-chart">
                                                              @(Html.Kendo().Chart<DieboldMobile.Models.SystemSummaryModel>()
                                                                .Name("SystemSummarychart")
                                                                .Title("")
                                                                .HtmlAttributes(new { style = "width:210px; height:150px" })
                                                                .Legend(legend => legend
                                                                .Position(ChartLegendPosition.Bottom)
                                                                )
                                                                .DataSource(dataSource => dataSource
                                                                        .Read(read => read.Action("FilterByDeviceTypeId", "SystemSummary").Data("loadExtraParams"))
                                                                    )
                                
                                                                .Series(series =>
                                                                {
                                                                    series.Pie(model => model.Value, model => model.Status);
                                                                })
                                                                 .SeriesColors(new string[] { "#7f3979", "#28B779", "#2255a4" })
                                                                 .Tooltip(tooltip => tooltip
                                                                        .Visible(true)
                                                                        .Template("#= kendo.format('{0:P}', percentage)#")
                                                                        )
                                                                    )
                                                            </div>
                                                    <!--try start -->
                                                            </div>
		                                            </div>
	                                                </div>
	                                            </div>
                                               </div>
                                            </div>*@
                                            <!--try End -->
                                    
                                </div>
                                <!-- VIDEO PAGE ENDS HERE -->
                            
                            </div>
                        </div>

                       

                    </article>
                </section>

				<section>
                	<article>
                	</article>
				</section>
                <!-- MAIN CONTAINER ENDS HERE -->
                        
                <!-- FOOTER STARTS HERE -->
                <footer>
				</footer>
                <!-- FOOTER ENDS HERE -->
                
            </div>
        </div>
        <!-- Main Row Ends here -->
	
</body>
</html>