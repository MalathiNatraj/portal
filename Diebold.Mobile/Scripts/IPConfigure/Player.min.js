Function.prototype.bind||(Function.prototype.bind=function(n){if(typeof this!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var r=Array.prototype.slice.call(arguments,1),u=this,t=function(){},i=function(){return u.apply(this instanceof t&&n?this:n,r.concat(Array.prototype.slice.call(arguments)))};return t.prototype=this.prototype,i.prototype=new t,i});var ipConfigure;(function(n){var u=function(){function n(){}return n}(),t,i,r;n.PlayerOptions=u,t=function(){function n(){}return n.ManagementUri="",n}(),n.Settings=t,i=function(){function n(n){var t,i,r;this._stageMouse=!1,this._mouseTime=new Date,this._controlsMouse=!1,this._showingControls=!1,this._addedStage=!1,this._addedControls=!1,this._player=null,t=this,this._parent=n,$(n).css("position","relative"),this._stage=$(n).find(".ipc-player-stage"),this._stage.length==0?(this._stage=$("<div><\/div>").addClass("ui-widget-content").addClass("ipc-player-stage").css({position:"absolute",top:"0",left:"0",right:"0",bottom:"0",background:"rgb(0, 0, 0)",color:"white",overflow:"none"}).appendTo(n),this._addedStage=!0):this._stage.length>1,this._stage.mouseenter(function(){t._stageMouse=!0,t._mouseTime=new Date}),i=0,r=new Date,this._stage.mousemove(function(){var n=new Date;r.getTime()+100>n.getTime()?i++:i=0,r=n,i>=10&&(t._mouseTime=n,i=0)}),this._stage.mouseleave(function(){t._stageMouse=!1}),this._controls=$(n).find(".ipc-player-controls"),this._controls.length==0?(this._controls=$("<div><\/div>").addClass("ipc-player-controls").css({position:"absolute",left:"0",right:"0",bottom:"0",zIndex:"1",height:"5%",background:"rgb(51, 51, 51)",backgroundColor:"rgba(255, 255, 255, 0.2)",color:"black",overflow:"none"}).appendTo(this._stage),this._addedControls=!0):this._controls.length>1,this._controls.mouseenter(function(){t._controlsMouse=!0}),this._controls.mouseleave(function(){t._controlsMouse=!1}),this._controls.hide(),this.Play=this.Play.bind(this),this.Stop=this.Stop.bind(this),this.Destroy=this.Destroy.bind(this)}return n.prototype.Play=function(n){this._player!=null&&(this._player.Destroy(),this._player=null),n.FPS=n.FPS||3,this._player=new r(this._stage[0]),this._player.Play(n)},n.prototype.Stop=function(){this._player!=null&&(this._player.Stop(),this._player=null)},n.prototype.Destroy=function(){this._player!=null&&(this._player.Destroy(),this._player=null),this._addedControls&&this._controls.remove(),this._addedStage&&this._stage.remove()},n}(),n.Player=i,r=function(){function n(n){var t=this;this._init=!1,this._proxy=!1,this._loaded=!1,this._parent=n,this._img=$("<img>").css({position:"absolute",top:"0",left:"0",right:"0",bottom:"0",zIndex:"0",backgroundColor:"rgba(0, 0, 0, 0.5)",color:"white",overflow:"none",height:"auto",width:"100%",margin:"auto"})[0],this.Play=this.Play.bind(this),this.Stop=this.Stop.bind(this),this.Destroy=this.Destroy.bind(this),this.OnLoad=this.OnLoad.bind(this),this.OnError=this.OnError.bind(this),this.OnAbort=this.OnAbort.bind(this),this.poll=this.poll.bind(this),this.fixAspectRatio=this.fixAspectRatio.bind(this),this._parent.onresize=function(){t.fixAspectRatio()},this._img.onload=this.OnLoad,this._img.onerror=this.OnError,this._img.onabort=this.OnAbort}return n.prototype.Play=function(n){this._options=n,this._lastRootUri!=n.RootUri&&(this._lastRootUri=n.RootUri,this._init=!1,this._proxy=!1),this._loaded=!1,this.poll()},n.prototype.Stop=function(){this._options=null,$(this._img).detach(),this._img.src=null},n.prototype.Destroy=function(){this._options=null,$(this._img).remove(),this._img.src=null},n.prototype.OnLoad=function(){this._loaded||(this._loaded=!0,$(this._img).appendTo(this._parent),this.fixAspectRatio()),this.poll()},n.prototype.OnError=function(){console&&console.log&&console.log("img.onerror, img.src="+this._img.src),this.poll()},n.prototype.OnAbort=function(){console&&console.log&&console.log("img.onabort, img.src="+this._img.src),this.poll()},n.prototype.poll=function(){var n=this;this._options!=null&&(this._init?setTimeout(function(){if(n._options!=null){var i="/ipConfigure/CameraProxy/"+n._options.CameraID.toString()+"/Stream/GetCurrentImage?nocache=true&"+(new Date).getTime();n._img.src=n._proxy?t.ManagementUri+"/proxy/"+n._options.ServerID+i:n._options.RootUri+i}},1e3/this._options.FPS):$.ajax(this._options.RootUri+"/ESM/PingService/Ping",{dataType:"jsonp",timeout:1e3}).done(function(){n._init=!0,n._proxy=!1,n.poll()}).fail(function(){n._init=!0,n._proxy=!0,n.poll()}))},n.prototype.fixAspectRatio=function(){var n=$(this._img),i=n.width(),r=n.height(),t=$(this._parent),u=t.width(),f=t.height();i/r<u/f?(n.css("width","auto"),n.css("height","100%")):(n.css("width","100%"),n.css("height","auto"))},n}()})(ipConfigure||(ipConfigure={}))